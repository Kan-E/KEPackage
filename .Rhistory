dir_name <- Gene_set
dir_name_1 <- paste(dir_name, "_convert", sep = "")
dir.create(dir_name_1, showWarnings = F)
gene_set_files <- list.files(path = Gene_set,
pattern = "*.txt")
gene_set_files <- gsub(".txt", "", gene_set_files)
for (name in gene_set_files) {
data.file <- paste(name, ".txt", sep = "")
print(data.file)
mouse = useMart("ensembl", dataset = "mmusculus_gene_ensembl",host="asia.ensembl.org")
human = useMart("ensembl", dataset = "hsapiens_gene_ensembl",host="asia.ensembl.org")
genes <- read.table(name, skip = 2)
genes <- genes$V1
genes = getLDS(attributes = c("mgi_symbol"), filters = "mgi_symbol",
values = genes ,mart = mouse,
attributesL = c("hgnc_symbol"),
martL = human, uniqueRows=T)
gene.file <- paste(name, ".txt", sep = "")
gene.file <- paste(paste(dir_name_1, "/", sep = ""), gene.file, sep = "")
write.table(genes, file = gene.file, row.names = F, col.names = T, quote = F)
}
}
GeneSetConversion("/Users/kanetoh/Desktop/gene_set_extraction/gene_set")
GeneSetConversion <- function(Gene_set) {
dir_name <- Gene_set
dir_name_1 <- paste(dir_name, "_convert", sep = "")
dir.create(dir_name_1, showWarnings = F)
gene_set_files <- list.files(path = Gene_set,
pattern = "*.txt")
gene_set_files <- gsub(".txt", "", gene_set_files)
for (name in gene_set_files) {
data.file <- paste(name, ".txt", sep = "")
print(data.file)
mouse = useMart("ensembl", dataset = "mmusculus_gene_ensembl",host="asia.ensembl.org")
human = useMart("ensembl", dataset = "hsapiens_gene_ensembl",host="asia.ensembl.org")
genes <- read.table(data.file, skip = 2)
genes <- genes$V1
genes = getLDS(attributes = c("mgi_symbol"), filters = "mgi_symbol",
values = genes ,mart = mouse,
attributesL = c("hgnc_symbol"),
martL = human, uniqueRows=T)
gene.file <- paste(paste(dir_name_1, "/", sep = ""), data.file, sep = "")
write.table(genes, file = gene.file, row.names = F, col.names = T, quote = F)
}
}
GeneSetConversion("/Users/kanetoh/Desktop/gene_set_extraction/gene_set")
GeneSetConversion("/Users/kanetoh/Desktop/gene_set_extraction/gene_set")
GeneSetConversion <- function(Gene_set) {
dir_name <- Gene_set
dir_name_1 <- paste(dir_name, "_convert", sep = "")
dir.create(dir_name_1, showWarnings = F)
gene_set_files <- list.files(path = Gene_set,
pattern = "*.txt")
gene_set_files <- gsub(".txt", "", gene_set_files)
gene_files_full <- list.files(path = Gene_set,
pattern = "*.txt", full.names = T)
gene_set_dir <- gsub(gene_set_files[1], "", gene_files_full[1])
gene_files_full <- gsub(".txt", "", gene_files_full)
for (name in gene_files_full) {
data.file <- paste(name, ".txt", sep = "")
print(data.file)
mouse = useMart("ensembl", dataset = "mmusculus_gene_ensembl",host="asia.ensembl.org")
human = useMart("ensembl", dataset = "hsapiens_gene_ensembl",host="asia.ensembl.org")
genes <- read.table(data.file, skip = 2)
genes <- genes$V1
genes = getLDS(attributes = c("mgi_symbol"), filters = "mgi_symbol",
values = genes ,mart = mouse,
attributesL = c("hgnc_symbol"),
martL = human, uniqueRows=T)
gene.file <- gsub(gene_set_dir, "", data.file)
gene.file <- paste(paste(dir_name_1, "/", sep = ""), gene.file, sep = "")
write.table(genes, file = gene.file, row.names = F, col.names = T, quote = F)
}
}
GeneSetConversion("/Users/kanetoh/Desktop/gene_set_extraction/gene_set")
GeneSetConversion <- function(Gene_set) {
dir_name <- Gene_set
dir_name_1 <- paste(dir_name, "_convert", sep = "")
dir.create(dir_name_1, showWarnings = F)
gene_set_files <- list.files(path = Gene_set,
pattern = "*.txt")
gene_set_files <- gsub(".txt", "", gene_set_files)
gene_files_full <- list.files(path = Gene_set,
pattern = "*.txt", full.names = T)
gene_set_dir <- gsub(gene_set_files[1], "", gene_files_full[1])
gene_files_full <- gsub(".txt", "", gene_files_full)
for (name in gene_files_full) {
data.file <- paste(name, ".txt", sep = "")
print(data.file)
genes <- read.table(data.file, skip = 2)
genes <- genes$V1
mouse = useMart("ensembl", dataset = "mmusculus_gene_ensembl",host="asia.ensembl.org")
human = useMart("ensembl", dataset = "hsapiens_gene_ensembl",host="asia.ensembl.org")
genes = getLDS(attributes = c("mgi_symbol"), filters = "mgi_symbol",
values = genes ,mart = mouse,
attributesL = c("hgnc_symbol"),
martL = human, uniqueRows=T)
gene.file <- gsub(gene_set_dir, "", data.file)
gene.file <- paste(paste(dir_name_1, "/", sep = ""), gene.file, sep = "")
write.table(genes, file = gene.file, row.names = F, col.names = T, quote = F)
}
}
GeneSetConversion("/Users/kanetoh/Desktop/gene_set_extraction/gene_set")
Gene_set = "/Users/kanetoh/Desktop/gene_set_extraction/gene_set"
dir_name <- Gene_set
dir_name_1 <- paste(dir_name, "_convert", sep = "")
dir.create(dir_name_1, showWarnings = F)
gene_set_files <- list.files(path = Gene_set,
pattern = "*.txt")
gene_set_files <- gsub(".txt", "", gene_set_files)
gene_files_full <- list.files(path = Gene_set,
pattern = "*.txt", full.names = T)
gene_set_dir <- gsub(gene_set_files[1], "", gene_files_full[1])
gene_files_full <- gsub(".txt", "", gene_files_full)
gene_files_full
gene_set_dir <- gsub(gene_set_files[1], "", gene_files_full[1])
gene_set_dir
name = "/Users/kanetoh/Desktop/gene_set_extraction/gene_set/KEGG_AMINO_SUGAR_AND_NUCLEOTIDE_SUGAR_METABOLISM"
data.file <- paste(name, ".txt", sep = "")
print(data.file)
genes <- read.table(data.file, skip = 2)
genes <- genes$V1
mouse = useMart("ensembl", dataset = "mmusculus_gene_ensembl",host="asia.ensembl.org")
human = useMart("ensembl", dataset = "hsapiens_gene_ensembl",host="asia.ensembl.org")
genes = getLDS(attributes = c("mgi_symbol"), filters = "mgi_symbol",
values = genes ,mart = mouse,
attributesL = c("hgnc_symbol"),
martL = human, uniqueRows=T)
gene.file <- gsub(gene_set_dir, "", data.file)
gene.file
gene.file <- paste(paste(dir_name_1, "/", sep = ""), gene.file, sep = "")
gene.file
write.table(genes, file = gene.file, row.names = F, col.names = T, quote = F)
GeneSetConversion <- function(Gene_set) {
dir_name <- Gene_set
dir_name_1 <- paste(dir_name, "_convert", sep = "")
dir.create(dir_name_1, showWarnings = F)
gene_set_files <- list.files(path = Gene_set,
pattern = "*.txt")
gene_set_files <- gsub(".txt", "", gene_set_files)
gene_files_full <- list.files(path = Gene_set,
pattern = "*.txt", full.names = T)
gene_set_dir <- gsub(gene_set_files[1], "", gene_files_full[1])
gene_files_full <- gsub(".txt", "", gene_files_full)
for (name in gene_files_full) {
data.file <- paste(name, ".txt", sep = "")
print(data.file)
genes <- read.table(data.file, skip = 2)
genes <- genes$V1
mouse = useMart("ensembl", dataset = "mmusculus_gene_ensembl",host="asia.ensembl.org")
human = useMart("ensembl", dataset = "hsapiens_gene_ensembl",host="asia.ensembl.org")
genes = getLDS(attributes = c("mgi_symbol"), filters = "mgi_symbol",
values = genes ,mart = mouse,
attributesL = c("hgnc_symbol"),
martL = human, uniqueRows=T)
gene.file <- gsub(gene_set_dir, "", data.file)
gene.file <- paste(paste(dir_name_1, "/", sep = ""), gene.file, sep = "")
write.table(genes, file = gene.file, row.names = F, col.names = T, quote = F)
}
}
GeneSetConversion(Gene_set = "/Users/kanetoh/Desktop/gene_set_extraction/gene_set")
GeneSetConversion <- function(Gene_set) {
dir_name <- Gene_set
dir_name_1 <- paste(dir_name, "_convert", sep = "")
dir.create(dir_name_1, showWarnings = F)
gene_set_files <- list.files(path = Gene_set,
pattern = "*.txt")
gene_set_files <- gsub(".txt", "", gene_set_files)
gene_files_full <- list.files(path = Gene_set,
pattern = "*.txt", full.names = T)
gene_set_dir <- gsub(gene_set_files[1], "", gene_files_full[1])
gene_files_full <- gsub(".txt", "", gene_files_full)
for (name in gene_files_full) {
data.file <- paste(name, ".txt", sep = "")
print(data.file)
genes <- read.table(data.file, skip = 2)
genes <- genes$V1
mouse = useMart("ensembl", dataset = "mmusculus_gene_ensembl",host="asia.ensembl.org")
human = useMart("ensembl", dataset = "hsapiens_gene_ensembl",host="asia.ensembl.org")
genes = getLDS(attributes = c("mgi_symbol"), filters = "mgi_symbol",
values = genes ,mart = mouse,
attributesL = c("hgnc_symbol"),
martL = human, uniqueRows=T)
gene.file <- gsub(gene_set_dir, "", data.file)
gene.file <- paste(paste(dir_name_1, "/", sep = ""), gene.file, sep = "")
write.table(genes, file = gene.file, sep="\t", quote=F, row.names = F)
}
}
GeneSetConversion(Gene_set = "/Users/kanetoh/Desktop/gene_set_extraction/gene_set")
data.file
gene.file <- gsub(gene_set_dir, "", data.file)
gene.file
gene.file <- paste(paste(dir_name_1, "/", sep = ""), gene.file, sep = "")
write.table(genes, file = gene.file, sep="\t", quote=F, row.names = F)
GeneSetConversion <- function(Gene_set) {
dir_name <- Gene_set
dir_name_1 <- paste(dir_name, "_convert", sep = "")
dir.create(dir_name_1, showWarnings = F)
gene_set_files <- list.files(path = Gene_set,
pattern = "*.txt")
gene_set_files <- gsub(".txt", "", gene_set_files)
gene_files_full <- list.files(path = Gene_set,
pattern = "*.txt", full.names = T)
gene_set_dir <- gsub(gene_set_files[1], "", gene_files_full[1])
gene_files_full <- gsub(".txt", "", gene_files_full)
for (name in gene_files_full) {
data.file <- paste(name, ".txt", sep = "")
print(data.file)
genes <- read.table(data.file, skip = 2)
genes <- genes$V1
mouse = useMart("ensembl", dataset = "mmusculus_gene_ensembl",host="asia.ensembl.org")
human = useMart("ensembl", dataset = "hsapiens_gene_ensembl",host="asia.ensembl.org")
genes = getLDS(attributes = c("mgi_symbol"), filters = "mgi_symbol",
values = genes ,mart = mouse,
attributesL = c("hgnc_symbol"),
martL = human, uniqueRows=T)
gene.file <- gsub(gene_set_dir, "", data.file)
gene.file <- paste(paste(dir_name_1, "/_C_", sep = ""), gene.file, sep = "")
write.table(genes, file = gene.file, sep="\t", quote=F, row.names = F)
}
}
GeneSetConversion(Gene_set = "/Users/kanetoh/Desktop/gene_set_extraction/gene_set")
GeneSetConversion <- function(Gene_set) {
dir_name <- Gene_set
dir_name_1 <- paste(dir_name, "_convert", sep = "")
dir.create(dir_name_1, showWarnings = F)
gene_set_files <- list.files(path = Gene_set,
pattern = "*.txt")
gene_set_files <- gsub(".txt", "", gene_set_files)
gene_files_full <- list.files(path = Gene_set,
pattern = "*.txt", full.names = T)
gene_set_dir <- gsub(gene_set_files[1], "", gene_files_full[1])
gene_files_full <- gsub(".txt", "", gene_files_full)
for (name in gene_files_full) {
data.file <- paste(name, ".txt", sep = "")
print(data.file)
genes <- read.table(data.file, skip = 2)
genes <- genes$V1
mouse = useMart("ensembl", dataset = "mmusculus_gene_ensembl",host="asia.ensembl.org")
human = useMart("ensembl", dataset = "hsapiens_gene_ensembl",host="asia.ensembl.org")
genes = getLDS(attributes = c("mgi_symbol"), filters = "mgi_symbol",
values = genes ,mart = mouse,
attributesL = c("hgnc_symbol"),
martL = human, uniqueRows=T)
gene.file <- gsub(gene_set_dir, "", data.file)
gene.file <- paste(paste(dir_name_1, "/C_", sep = ""), gene.file, sep = "")
write.table(genes, file = gene.file, sep="\t", quote=F, row.names = F)
}
}
GeneSetConversion(Gene_set = "/Users/kanetoh/Desktop/gene_set_extraction/gene_set")
library(biomaRt)
GeneSetConversion <- function(Gene_set) {
dir_name <- Gene_set
dir_name_1 <- paste(dir_name, "_convert", sep = "")
dir.create(dir_name_1, showWarnings = F)
gene_set_files <- list.files(path = Gene_set,
pattern = "*.txt")
gene_set_files <- gsub(".txt", "", gene_set_files)
gene_files_full <- list.files(path = Gene_set,
pattern = "*.txt", full.names = T)
gene_set_dir <- gsub(gene_set_files[1], "", gene_files_full[1])
gene_files_full <- gsub(".txt", "", gene_files_full)
for (name in gene_files_full) {
data.file <- paste(name, ".txt", sep = "")
print(data.file)
genes <- read.table(data.file, skip = 2)
genes <- genes$V1
mouse = useMart("ensembl", dataset = "mmusculus_gene_ensembl",host="asia.ensembl.org")
human = useMart("ensembl", dataset = "hsapiens_gene_ensembl",host="asia.ensembl.org")
genes = getLDS(attributes = c("mgi_symbol"), filters = "mgi_symbol",
values = genes ,mart = mouse,
attributesL = c("hgnc_symbol"),
martL = human, uniqueRows=T)
gene.file <- gsub(gene_set_dir, "", data.file)
gene.file <- paste(paste(dir_name_1, "/", sep = ""), gene.file, sep = "")
write.table(genes, file = gene.file, sep="\t", quote=F, row.names = F)
}
}
GeneSetConversion(Gene_set = "/Users/kanetoh/Desktop/gene_set_extraction/gene_set")
GeneSetConversion <- function(Gene_set) {
dir_name <- Gene_set
dir_name_1 <- paste(dir_name, "_convert", sep = "")
dir.create(dir_name_1, showWarnings = F)
gene_set_files <- list.files(path = Gene_set,
pattern = "*.txt")
gene_set_files <- gsub(".txt", "", gene_set_files)
gene_files_full <- list.files(path = Gene_set,
pattern = "*.txt", full.names = T)
gene_set_dir <- gsub(gene_set_files[1], "", gene_files_full[1])
gene_files_full <- gsub(".txt", "", gene_files_full)
for (name in gene_files_full) {
data.file <- paste(name, ".txt", sep = "")
print(data.file)
genes <- read.table(data.file, skip = 2)
genes <- genes$V1
mouse = useMart("ensembl", dataset = "mmusculus_gene_ensembl",host="asia.ensembl.org")
human = useMart("ensembl", dataset = "hsapiens_gene_ensembl",host="asia.ensembl.org")
genes = getLDS(attributes = c("mgi_symbol"), filters = "mgi_symbol",
values = genes ,mart = mouse,
attributesL = c("hgnc_symbol"),
martL = human, uniqueRows=T)
gene.file <- gsub(gene_set_dir, "", data.file)
gene.file <- paste(paste(dir_name_1, "/", sep = ""), gene.file, sep = "")
write.table(genes, file = gene.file, sep="\t", quote=F, row.names = F, append=T)
}
}
GeneSetConversion(Gene_set = "/Users/kanetoh/Desktop/gene_set_extraction/gene_set")
Gene_set = "/Users/kanetoh/Desktop/gene_set_extraction/gene_set"
dir_name <- Gene_set
dir_name_1 <- paste(dir_name, "_convert", sep = "")
dir.create(dir_name_1, showWarnings = F)
gene_set_files <- list.files(path = Gene_set,
pattern = "*.txt")
gene_set_files <- gsub(".txt", "", gene_set_files)
gene_files_full <- list.files(path = Gene_set,
pattern = "*.txt", full.names = T)
gene_set_dir <- gsub(gene_set_files[1], "", gene_files_full[1])
gene_files_full <- gsub(".txt", "", gene_files_full)
gene_files_full
name <- "/Users/kanetoh/Desktop/gene_set_extraction/gene_set/KEGG_AMINO_SUGAR_AND_NUCLEOTIDE_SUGAR_METABOLISM"
data.file <- paste(name, ".txt", sep = "")
print(data.file)
genes <- read.table(data.file, skip = 2)
genes <- genes$V1
mouse = useMart("ensembl", dataset = "mmusculus_gene_ensembl",host="asia.ensembl.org")
human = useMart("ensembl", dataset = "hsapiens_gene_ensembl",host="asia.ensembl.org")
genes = getLDS(attributes = c("mgi_symbol"), filters = "mgi_symbol",
values = genes ,mart = mouse,
attributesL = c("hgnc_symbol"),
martL = human, uniqueRows=T)
gene.file <- gsub(gene_set_dir, "", data.file)
gene.file <- paste(paste(dir_name_1, "/", sep = ""), gene.file, sep = "")
genes.file
gene.file
gene.file <- gsub(gene_set_dir, "", data.file)
gene.file
gene.file <- gsub(gene_set_dir, "", data.file)
gene.file
gene_set_dir
dir_name <- Gene_set
dir_name_1 <- paste(dir_name, "_convert", sep = "")
dir.create(dir_name_1, showWarnings = F)
gene_set_files <- list.files(path = Gene_set,
pattern = "*.txt")
gene_set_files <- gsub(".txt", "", gene_set_files)
gene_files_full <- list.files(path = Gene_set,
pattern = "*.txt", full.names = T)
gene_files_full <- gsub(".txt", "", gene_files_full)
gene_set_dir <- gsub(gene_set_files[1], "", gene_files_full[1])
gene_files_full <- gsub(".txt", "", gene_files_full)
genes = getLDS(attributes = c("mgi_symbol"), filters = "mgi_symbol",
values = genes ,mart = mouse,
attributesL = c("hgnc_symbol"),
martL = human, uniqueRows=T)
gene.file <- gsub(gene_set_dir, "", data.file)
gene.file <- paste(paste(dir_name_1, "/", sep = ""), gene.file, sep = "")
write.table(genes, file = gene.file, sep="\t", quote=F, row.names = F, append=T)
for (name in gene_files_full) {
data.file <- paste(name, ".txt", sep = "")
print(data.file)
genes <- read.table(data.file, skip = 2)
genes <- genes$V1
mouse = useMart("ensembl", dataset = "mmusculus_gene_ensembl",host="asia.ensembl.org")
human = useMart("ensembl", dataset = "hsapiens_gene_ensembl",host="asia.ensembl.org")
genes = getLDS(attributes = c("mgi_symbol"), filters = "mgi_symbol",
values = genes ,mart = mouse,
attributesL = c("hgnc_symbol"),
martL = human, uniqueRows=T)
gene.file <- gsub(gene_set_dir, "", data.file)
gene.file <- paste(paste(dir_name_1, "/", sep = ""), gene.file, sep = "")
write.table(genes, file = gene.file, sep="\t", quote=F, row.names = F, append=T)
}
sessionInfo()
library(KEPackage)
KEPackage::GeneSetConversion(Gene_set = "/Users/kanetoh/Desktop/gene_set_extraction/gene_set/")
data <- read.table(Gene_set = "/Users/kanetoh/Desktop/gene_set_extraction/gene_set/")
data <- read.table("/Users/kanetoh/Desktop/gene_set_extraction/gene_set/")
data <- read.table("/Users/kanetoh/Desktop/gene_set_extraction/gene_set/KEGG_AMINO_SUGAR_AND_NUCLEOTIDE_SUGAR_METABOLISM.txt")
data <- read.table("/Users/kanetoh/Desktop/gene_set_extraction/gene_set/KEGG_AMINO_SUGAR_AND_NUCLEOTIDE_SUGAR_METABOLISM.txt",header = T)
data <- read.table("/Users/kanetoh/Desktop/gene_set_extraction/gene_set/KEGG_CITRATE_CYCLE_TCA_CYCLE.txt)
)
""
)
data <- read.table("/Users/kanetoh/Desktop/gene_set_extraction/gene_set/KEGG_CITRATE_CYCLE_TCA_CYCLE.txt")
data <- read.table("/Users/kanetoh/Desktop/gene_set_extraction/gene_set/KEGG_CITRATE_CYCLE_TCA_CYCLE.txt",skip = 1)
data <- read.table("/Users/kanetoh/Desktop/gene_set_extraction/gene_set/KEGG_CITRATE_CYCLE_TCA_CYCLE.txt",skip = 2)
head(data)
data2 <- "KEGG_CITRATE_CYCLE_TCA_CYCLE"
data3 <-rbind(data2,data)
head(data3)
Gene_set = "/Users/kanetoh/Desktop/gene_set_extraction/gene_set/"
dir_name <- Gene_set
dir_name_1 <- paste(dir_name, "_convert", sep = "")
dir.create(dir_name_1, showWarnings = F)
gene_set_files <- list.files(path = Gene_set,
pattern = "*.txt")
gene_set_files <- gsub(".txt", "", gene_set_files)
gene_files_full <- list.files(path = Gene_set,
pattern = "*.txt", full.names = T)
gene_files_full <- gsub(".txt", "", gene_files_full)
gene_set_dir <- gsub(gene_set_files[1], "", gene_files_full[1])
gene_files_full <- gsub(".txt", "", gene_files_full)
gene_files_full
name = "/Users/kanetoh/Desktop/gene_set_extraction/gene_set//KEGG_AMINO_SUGAR_AND_NUCLEOTIDE_SUGAR_METABOLISM"
data.file <- paste(name, ".txt", sep = "")
print(data.file)
genes <- read.table(data.file, skip = 2)
genes <- genes$V1
mouse = useMart("ensembl", dataset = "mmusculus_gene_ensembl",host="asia.ensembl.org")
human = useMart("ensembl", dataset = "hsapiens_gene_ensembl",host="asia.ensembl.org")
genes = getLDS(attributes = c("mgi_symbol"), filters = "mgi_symbol",
values = genes ,mart = mouse,
attributesL = c("hgnc_symbol"),
martL = human, uniqueRows=T)
gene.file <- gsub(gene_set_dir, "", data.file)
gene.file
set_name <- gsub(".txt", "", gene.file)
set_name
data <- rbind(set_name,genes)
head(data)
head(data)
genes
library(KEPackage)
GeneSetConversion(Gene_set = "/Users/kanetoh/Desktop/gene_set_extraction/gene_set/")
KEPackage::GeneSetConversion(Gene_set = "/Users/kanetoh/Desktop/gene_set_extraction/gene_set/")
gene.file
gene.file <- gsub(gene_set_dir, "", data.file)
gene.file <- paste(paste(dir_name_1, "/", sep = ""), gene.file, sep = "")
gene.file
set_name <- gsub(".txt", "", gene.file)
data <- rbind(set_name, genes)
write.table(data, file = gene.file, sep="\t", quote=F, row.names = T, append=T)
data
gene.file <- gsub(gene_set_dir, "", data.file)
gene.file2 <- paste(paste(dir_name_1, "/", sep = ""), gene.file, sep = "")
write.table(genes, file = gene.file2, sep="\t", quote=F, row.names = F)
genes <- read.table(gene.file2)
set_name <- gsub(".txt", "", gene.file)
data <- rbind(set_name, genes)
write.table(data, file = gene.file2, sep="\t", quote=F, row.names = T, append=T)
data
gene.file2
data
write.table(data, file = gene.file2, sep="\t", quote=F, row.names = F, append=T)
for (name in gene_files_full) {
data.file <- paste(name, ".txt", sep = "")
print(data.file)
genes <- read.table(data.file, skip = 2)
genes <- genes$V1
mouse = useMart("ensembl", dataset = "mmusculus_gene_ensembl",host="asia.ensembl.org")
human = useMart("ensembl", dataset = "hsapiens_gene_ensembl",host="asia.ensembl.org")
genes = getLDS(attributes = c("mgi_symbol"), filters = "mgi_symbol",
values = genes ,mart = mouse,
attributesL = c("hgnc_symbol"),
martL = human, uniqueRows=T)
gene.file <- gsub(gene_set_dir, "", data.file)
gene.file2 <- paste(paste(dir_name_1, "/", sep = ""), gene.file, sep = "")
write.table(genes, file = gene.file2, sep="\t", quote=F, row.names = F)
genes <- read.table(gene.file2)
set_name <- gsub(".txt", "", gene.file)
data <- rbind(set_name, genes)
write.table(data, file = gene.file2, sep="\t", quote=F, row.names = F, append=T)
}
write.table(data, file = gene.file2, sep="\t", quote=F, row.names = F, append=T)
data
gene.file2
write.table(genes, file = gene.file2, sep="\t", quote=F, row.names = F)
write.table(data, file = gene.file2, sep="\t", quote=F, row.names = F)
write.table(data, file = gene.file2, sep="\t", quote=F, row.names = F, col.names = F)
sessionInfo()
help(package ="KEPackage")
KEPackage::kmeansClustring()
KEPackage::kmeansClustring(Count_matrix = "/Users/kanetoh/Desktop/デモデータ/RNAseq_TPM_pro_sen.txt", Species = "human",km = 3,km_repeats = 10,basemean_cutoff = 1,variance_cutoff = 1000)
devtools::load_all(".")
devtools::load_all(".")
KEPackage::kmeansClustring(Count_matrix = "/Users/kanetoh/Desktop/デモデータ/RNAseq_TPM_pro_sen.txt", Species = "human",km = 3,km_repeats = 10,basemean_cutoff = 1,variance_cutoff = 1000)
devtools::load_all(".")
KEPackage::kmeansClustring(Count_matrix = "/Users/kanetoh/Desktop/デモデータ/RNAseq_TPM_pro_sen.txt", Species = "human",km = 3,km_repeats = 10,basemean_cutoff = 1,variance_cutoff = 1000)
Count_matrix = "/Users/kanetoh/Desktop/デモデータ/RNAseq_TPM_pro_sen.txt"
dir_name <- gsub("\\..+$", "", Count_matrix)
km=3
dir_name <- paste(dir_name, paste("_km", km, sep = ""), sep = "")
dir.create(dir_name, showWarnings = F)
RNAseq <- read.table(Count_matrix, header=T, row.names = 1)
RNAseq2 <- dplyr::filter(RNAseq, apply(RNAseq,1,mean) > basemean_cutoff)
RNAseq3 <- RNAseq2[order(apply(RNAseq2, 1, mad), decreasing = T)[1:variance_cutoff],]
basemean_cutoff=1
variance_cutoff=1000
RNAseq2 <- dplyr::filter(RNAseq, apply(RNAseq,1,mean) > basemean_cutoff)
RNAseq3 <- RNAseq2[order(apply(RNAseq2, 1, mad), decreasing = T)[1:variance_cutoff],]
data.z <- genescale(RNAseq3, axis = 1, method = "Z")
ht <- Heatmap(data.z, name = "z-score",
clustering_method_columns = 'ward.D2',
row_km= km, cluster_row_slices = F, row_km_repeats = km_repeats,
show_row_names = F)
km_repeats =10
km=3
ht <- Heatmap(data.z, name = "z-score",
clustering_method_columns = 'ward.D2',
row_km= km, cluster_row_slices = F, row_km_repeats = km_repeats,
show_row_names = F)
ht <- draw(ht)
r.dend <- row_dend(ht)
rcl.list <- row_order(ht)
lapply(rcl.list, function(x) length(x))
for (i in 1:length(row_order(ht))){ if (i == 1) {
clu <- t(t(row.names(data.z[row_order(ht)[[i]],])))
out <- cbind(clu, paste("cluster", i, sep=""))
colnames(out) <- c("GeneID", "Cluster")} else {
clu <- t(t(row.names(data.z[row_order(ht)[[i]],])))
clu <- cbind(clu, paste("cluster", i, sep=""))
out <- rbind(out, clu)}}
