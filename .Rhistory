deg_name <- gsub("\\..+$", "", Count_matrix)
deg_name <- paste(deg_name, "_DEG_count.csv", sep = "")
write.table(data5, file = deg_name, row.names = T, col.names = T, sep = ",", quote = F)
degtop_name <- gsub("\\..+$", "", Count_matrix)
degtop_name <- paste(degtop_name, "_top_DEG.pdf", sep = "")
pdf(degtop_name,height = 10, width = 10)
plot(ggpubr::ggboxplot(up50, x = "sample", y = "value",
fill = "sample", facet.by = "Row.names",
scales = "free", add = "jitter",
xlab = "gene", ylab = "TPM")+
ggplot2::theme(axis.text.x= ggplot2::element_text(size = 5),
axis.text.y= ggplot2::element_text(size = 10)) +
ggplot2::scale_y_continuous(limits = c(0, NA)))
plot(ggpubr::ggboxplot(down50, x = "sample", y = "value",
fill = "sample", facet.by = "Row.names",
scales = "free", add = "jitter",
xlab = "gene", ylab = "TPM")+
ggplot2::theme(axis.text.x= ggplot2::element_text(size = 5),
axis.text.y= ggplot2::element_text(size = 10)) +
ggplot2::scale_y_continuous(limits = c(0, NA)))
dev.off()
up50 <- data4[1:400,8:(7 + Cond_1 + Cond_2)]
View(up50)
heatmap
ggmaplot
View(data4)
up_all <- dplyr::filter(data4, group = "upregulated")
up_all <- dplyr::filter(data4, group == "upregulated")
up_all <- dplyr::filter(data4, log2FoldChange > 0)
#FC上位50下位50をboxplot
data4 <- data3[sort(data3$log2FoldChange, decreasing = T, index=T)$ix,]
up_all <- dplyr::filter(data4, log2FoldChange > 0)
head(data4)
data <- read.table(EBseq_Result,header = T, row.names = 1)
count <- read.table(Count_matrix,header=T, row.names = 1)
data <- merge(data,count, by=0)
switch (Species,
"mouse" = org <- org.Mm.eg.db,
"human" = org <- org.Hs.eg.db)
switch (Species,
"mouse" = org_code <- "mmu",
"human" = org_code <- "hsa")
my.symbols <- data$Row.names
gene_IDs<-AnnotationDbi::select(org,keys = my.symbols,
keytype = "SYMBOL",
columns = c("ENTREZID", "SYMBOL", "UNIPROT"))
colnames(gene_IDs) <- c("Row.names","ENTREZID","UNIPROT")
data <- merge(data, gene_IDs, by="Row.names")
data <- data %>% distinct(Row.names, .keep_all = T)
log2FoldChange <- -1 * log2(data$PostFC)
data <- cbind(data, log2FoldChange)
baseMean <- (data$C1Mean + data$C2Mean)*(1/2)
data <- cbind(data, baseMean)
padj <- data$PPEE
data <- cbind(data, padj)
##MA-plot
m1 <- as.grob(ggmaplot(data, fdr = fdr, fc = fc, size = 0.4,
palette = c("#B31B21", "#1465AC", "darkgray"),
genenames = as.vector(data$Row.names),
legend = "top", top = 20,
font.label = c("bold", 6),font.legend = "bold",
font.main = "bold",
ggtheme = ggplot2::theme_minimal(),
select.top.method = "fc"))
data2 <- data[abs(data$log2FoldChange) > log(fc, 2),]
data2$group <- "upregulated"
fdr =0.05
fc = 2
data2 <- data[abs(data$log2FoldChange) > log(fc, 2),]
data2$group <- "upregulated"
data2$group[data2$log2FoldChange < 0] <- "downregulated"
data3 <- data2[abs(data2$PPEE) < fdr,]
head(data3)
#FC上位50下位50をboxplot
data4 <- data3[sort(data3$log2FoldChange, decreasing = T, index=T)$ix,]
up_all <- dplyr::filter(data4, log2FoldChange > 0)
up50 <- up_all[1:50,8:(7 + Cond_1 + Cond_2)]
up50$Row.names <- up50[1:50,]$Row.names
up50 <- up50 %>% gather(key=sample, value=value,-Row.names)
up50$sample <- gsub("\\_.+$", "", up50$sample)
up50$Row.names <- as.factor(up50$Row.names)
head(up)
head(up50)
#FC上位50下位50をboxplot
data4 <- data3[sort(data3$log2FoldChange, decreasing = T, index=T)$ix,]
up_all <- dplyr::filter(data4, log2FoldChange > 0)
up50 <- up_all[1:50,8:(7 + Cond_1 + Cond_2)]
up50$Row.names <- up50[1:50,]$Row.names
up50 <- up50 %>% gather(key=sample, value=value,-Row.names)
head(up50)
head(up_all)
head(data4)
up50 <- up_all[1:50,8:(7 + Cond_1 + Cond_2)]
head(up50)
up50$Row.names <- up50[1:50,]$Row.names
head(up50)
up50$Row.names <- up_all[1:50,]$Row.names
up50 <- up50 %>% gather(key=sample, value=value,-Row.names)
up50$sample <- gsub("\\_.+$", "", up50$sample)
up50$Row.names <- as.factor(up50$Row.names)
up50$sample <- as.factor(up50$sample)
up50$value <- as.numeric(up50$value)
data4 <- data3[sort(data3$log2FoldChange, decreasing = F, index=T)$ix,]
down_all <- dplyr::filter(data4, log2FoldChange < 0)
down50 <- down_all[1:50,8:(7 + Cond_1 + Cond_2)]
down50$Row.names <- down_all[1:50,]$Row.names
down50 <- down50 %>% gather(key=sample, value=value,-Row.names)
down50$sample <- gsub("\\_.+$", "", down50$sample)
down50$Row.names <- as.factor(down50$Row.names)
down50$sample <- as.factor(down50$sample)
down50$value <- as.numeric(down50$value)
data5 <- data4[,8:(7 + Cond_1 + Cond_2)]
rownames(data5) <- data4$Row.names
deg_name <- gsub("\\..+$", "", Count_matrix)
deg_name <- paste(deg_name, "_DEG_count.csv", sep = "")
write.table(data5, file = deg_name, row.names = T, col.names = T, sep = ",", quote = F)
degtop_name <- gsub("\\..+$", "", Count_matrix)
degtop_name <- paste(degtop_name, "_top_DEG.pdf", sep = "")
pdf(degtop_name,height = 10, width = 10)
plot(ggpubr::ggboxplot(up50, x = "sample", y = "value",
fill = "sample", facet.by = "Row.names",
scales = "free", add = "jitter",
xlab = "gene", ylab = "TPM")+
ggplot2::theme(axis.text.x= ggplot2::element_text(size = 5),
axis.text.y= ggplot2::element_text(size = 10)) +
ggplot2::scale_y_continuous(limits = c(0, NA)))
plot(ggpubr::ggboxplot(down50, x = "sample", y = "value",
fill = "sample", facet.by = "Row.names",
scales = "free", add = "jitter",
xlab = "gene", ylab = "TPM")+
ggplot2::theme(axis.text.x= ggplot2::element_text(size = 5),
axis.text.y= ggplot2::element_text(size = 10)) +
ggplot2::scale_y_continuous(limits = c(0, NA)))
dev.off()
devtools::load_all(".")
pairwiseEBseq_viewer(Count_matrix = "/Users/kanetoh/Downloads/RNA-seq analysis/aKG-p53 paper/GeneMat_TPM_pair.txt", EBseq_Result = "/Users/kanetoh/Downloads/RNA-seq analysis/aKG-p53 paper/GeneMat_Count_result_new.txt",Species = "human",Cond_1 = 3, Cond_2 = 3, fc = 2.5, fdr = 0.01)
pairwiseEBseq_viewer(Count_matrix = "/Users/kanetoh/Downloads/RNA-seq analysis/aKG-p53 paper/GeneMat_TPM_pair.txt", EBseq_Result = "/Users/kanetoh/Downloads/RNA-seq analysis/aKG-p53 paper/GeneMat_Count_result_new.txt",Species = "human",Cond_1 = 2, Cond_2 = 2, fc = 2.5, fdr = 0.01)
formula_res <- try(compareCluster(ENTREZID~group, data=data3,fun="enrichKEGG", organism=org_code, universe = universe))
devtools::load_all(".")
pairwiseEBseq_viewer(Count_matrix = "/Users/kanetoh/Downloads/RNA-seq analysis/aKG-p53 paper/GeneMat_TPM_pair.txt", EBseq_Result = "/Users/kanetoh/Downloads/RNA-seq analysis/aKG-p53 paper/GeneMat_Count_result_new.txt",Species = "human",Cond_1 = 2, Cond_2 = 2, fc = 2.5, fdr = 0.01)
pairwiseEBseq_viewer(Count_matrix = "/Users/kanetoh/Downloads/RNA-seq analysis/aKG-p53 paper/GeneMat_TPM_pair.txt", EBseq_Result = "/Users/kanetoh/Downloads/RNA-seq analysis/aKG-p53 paper/GeneMat_Count_result_new.txt",Species = "human",Cond_1 = 2, Cond_2 = 2, fc = 2, fdr = 0.01)
pairwiseEBseq_viewer(Count_matrix = "/Users/kanetoh/Downloads/RNA-seq analysis/aKG-p53 paper/GeneMat_TPM_pair.txt", EBseq_Result = "/Users/kanetoh/Downloads/RNA-seq analysis/aKG-p53 paper/GeneMat_Count_result_new.txt",Species = "human",Cond_1 = 2, Cond_2 = 2, fc = 2, fdr = 0.05)
devtools::load_all(".")
pairwiseEBseq_viewer(Count_matrix = "/Users/kanetoh/Downloads/RNA-seq analysis/aKG-p53 paper/GeneMat_TPM_pair.txt", EBseq_Result = "/Users/kanetoh/Downloads/RNA-seq analysis/aKG-p53 paper/GeneMat_Count_result_new.txt",Species = "human",Cond_1 = 2, Cond_2 = 2, fc = 2, fdr = 0.05)
pairwiseEBseq_viewer(Count_matrix = "/Users/kanetoh/Downloads/RNA-seq analysis/aKG-p53 paper/GeneMat_TPM_pair.txt", EBseq_Result = "/Users/kanetoh/Downloads/RNA-seq analysis/aKG-p53 paper/GeneMat_Count_result_new.txt",Species = "human",Cond_1 = 2, Cond_2 = 2, fc = 1.5, fdr = 0.05)
pairwiseEBseq_viewer(Count_matrix = "/Users/kanetoh/Downloads/RNA-seq analysis/aKG-p53 paper/GeneMat_TPM_pair.txt", EBseq_Result = "/Users/kanetoh/Downloads/RNA-seq analysis/aKG-p53 paper/GeneMat_Count_result_new.txt",Species = "mouse",Cond_1 = 2, Cond_2 = 2, fc = 1.5, fdr = 0.01)
pairwiseEBseq_viewer(Count_matrix = "/Users/kanetoh/Downloads/RNA-seq analysis/aKG-p53 paper/GeneMat_TPM_pair.txt", EBseq_Result = "/Users/kanetoh/Downloads/RNA-seq analysis/aKG-p53 paper/GeneMat_Count_result_new.txt",Species = "mouse",Cond_1 = 2, Cond_2 = 2, fc = 2, fdr = 0.01)
pairwiseEBseq_viewer(Count_matrix = "/Users/kanetoh/Downloads/RNA-seq analysis/aKG-p53 paper/GeneMat_TPM_pair.txt", EBseq_Result = "/Users/kanetoh/Downloads/RNA-seq analysis/aKG-p53 paper/GeneMat_Count_result_new.txt",Species = "mouse",Cond_1 = 2, Cond_2 = 2, fc = 3, fdr = 0.01)
dir_name <- Count_matrix
dir_name <- paste(dir_name, paste("_fc", fc, sep = ""), sep = "")
dir_name <- paste(dir_name, paste("_fdr", fdr, sep = ""), sep = "")
dir_name
dir_name <- gsub(".txt", "", Count_matrix)
dir_name <- paste(dir_name, paste("_fc", fc, sep = ""), sep = "")
dir_name <- paste(dir_name, paste("_fdr", fdr, sep = ""), sep = "")
dir_name
ma_name <- paste("\\..+$", "", Count_matrix)
ma_name <- paste(paste(dir_name, "/", sep = ""),
ma_name, sep = "")
ma_name <- paste(ma_name, "_ma-heatmap.pdf", sep = "")
ma_name
ma_name <- gsub("\\..+$", "", Count_matrix)
ma_name <- paste(paste(dir_name, "/", sep = ""),
ma_name, sep = "")
ma_name <- paste(ma_name, "_ma-heatmap.pdf", sep = "")
ma_name
ma_name <- paste(paste(dir_name, "/", sep = ""),
"ma-heatmap.pdf", sep = "")
ma_name
devtools::load_all(".")
pairwiseEBseq_viewer(Count_matrix = "/Users/kanetoh/Downloads/RNA-seq analysis/aKG-p53 paper/GeneMat_TPM_pair.txt", EBseq_Result = "/Users/kanetoh/Downloads/RNA-seq analysis/aKG-p53 paper/GeneMat_Count_result_new.txt",Species = "mouse",Cond_1 = 2, Cond_2 = 2, fc = 3, fdr = 0.01)
pairwiseEBseq_viewer(Count_matrix = "/Users/kanetoh/Downloads/RNA-seq analysis/aKG-p53 paper/GeneMat_TPM_pair.txt", EBseq_Result = "/Users/kanetoh/Downloads/RNA-seq analysis/aKG-p53 paper/GeneMat_Count_result_new.txt",Species = "mouse",Cond_1 = 2, Cond_2 = 2, fc = 2, fdr = 0.01)
pairwiseEBseq_viewer(Count_matrix = "/Users/kanetoh/Downloads/RNA-seq analysis/aKG-p53 paper/GeneMat_TPM_pair.txt", EBseq_Result = "/Users/kanetoh/Downloads/RNA-seq analysis/aKG-p53 paper/GeneMat_Count_result_new.txt",Species = "mouse",Cond_1 = 2, Cond_2 = 2)
help(package ="clusterProfiler")
head(EBseq_Result)
data <- read.table(EBseq_Result,header = T, row.names = 1)
head(data)
library(KEPackage)
devtools::load_all(".")
DEG_overview(Count_matrix = "/Users/kanetoh/Downloads/RNA-seq analysis/aKG-p53 paper/GeneMat_TPM_pair.txt", DEG_result = "/Users/kanetoh/Downloads/RNA-seq analysis/aKG-p53 paper/GeneMat_Count_result_new.txt", Type = "EBseq", Species = "mouse",Cond_1 = 2, Cond_2 = 2, fc = 2, fdr = 0.01)
data <- read.table(EBseq_Result,header = T, row.names = 1)
count <- read.table(Count_matrix,header=T, row.names = 1)
data <- merge(data,count, by=0)
data$padj <- data$PPEE
head(data)
data$log2FoldChange <- -1 * log2(data$PostFC)
head(data)
switch (Species,
"mouse" = org <- org.Mm.eg.db,
"human" = org <- org.Hs.eg.db)
switch (Species,
"mouse" = org_code <- "mmu",
"human" = org_code <- "hsa")
if (Type == "EBseq"){
data$padj <- data$PPEE
}
if (Type == "EBseq"){
data$log2FoldChange <- -1 * log2(data$PostFC)
}
my.symbols <- data$Row.names
gene_IDs<-AnnotationDbi::select(org,keys = my.symbols,
keytype = "SYMBOL",
columns = c("ENTREZID", "SYMBOL", "UNIPROT"))
devtools::load_all(".")
DEG_overview(Count_matrix = "/Users/kanetoh/Downloads/RNA-seq analysis/aKG-p53 paper/GeneMat_TPM_pair.txt", DEG_result = "/Users/kanetoh/Downloads/RNA-seq analysis/aKG-p53 paper/GeneMat_Count_result_new.txt", Type = "EBseq", Species = "mouse",Cond_1 = 2, Cond_2 = 2, fc = 2, fdr = 0.01)
DEG_overview(Count_matrix = "/Users/kanetoh/Downloads/RNA-seq analysis/aKG-p53 paper/GeneMat_TPM_pair.txt", DEG_result = "/Users/kanetoh/Downloads/RNA-seq analysis/aKG-p53 paper/GeneMat_Count_result_new.txt", Type = "EBseq", Species = "mouse",Cond_1 = 2, Cond_2 = 2, fc = 1.5, fdr = 0.01)
library(rnaseqviewer)
library(rnaseqviewer)
setwd("~/Desktop/デモデータ/acly")
DEG_overview(Count_matrix = "GeneMat_TPM.txt",DEG_result = "GeneMat_result_new.txt",Type = "EBseq",Species = "human",Cond_1 = 3,Cond_2 = 3,fdr = 0.01,fc = 4)
devtools::load_all("~/Desktop/Rproject/rnaseqviewer")
DEG_overview(Count_matrix = "GeneMat_TPM.txt",DEG_result = "GeneMat_result_new.txt",Type = "EBseq",Species = "human",Cond_1 = 3,Cond_2 = 3,fdr = 0.01,fc = 4)
kmeansClustring(Count_matrix = "GeneMat_TPM.txt",Species = "human",km = 4,km_repeats = 100,basemean_cutoff = 10,variance_cutoff = )
kmeansClustring(Count_matrix = "GeneMat_TPM.txt",Species = "human",km = 4,km_repeats = 100,basemean_cutoff = 10,variance_cutoff = 500)
devtools::install_github("Kan-E/rnaseqviewer")
setwd("~/Downloads/RNA-seq analysis/aKG-p53 paper")
rnaseqviewer::DEG_overview()
devtools::install_github("Kan-E/rnaseqviewer")
rnaseqviewer::DEG_overview(Count_matrix = "GeneMat_TPM_pair.txt",DEG_result = "GeneMat_Count_result_new.txt")
rnaseqviewer::DEG_overview
setwd("~/Downloads/RNA-seq analysis/aKG-p53 paper")
Count_matrix = "GeneMat_TPM_pair.txt"
DEseq_result = "GeneMat_Count_result_new.txt"
Type = "EBseq"
Cond_1 = 3
Cond_2 = 3
Species ="human"
Species ="mouse"
data <- read.table(DEG_result,header = T, row.names = 1)
count <- read.table(Count_matrix,header=T, row.names = 1)
data <- merge(data,count, by=0)
DEG_result = "GeneMat_Count_result_new.txt"
data <- read.table(DEG_result,header = T, row.names = 1)
count <- read.table(Count_matrix,header=T, row.names = 1)
data <- merge(data,count, by=0)
switch (Species,
"mouse" = org <- org.Mm.eg.db,
"human" = org <- org.Hs.eg.db)
switch (Species,
"mouse" = org_code <- "mmu",
"human" = org_code <- "hsa")
library(org.Mm.eg.db)
switch (Species,
"mouse" = org <- org.Mm.eg.db,
"human" = org <- org.Hs.eg.db)
switch (Species,
"mouse" = org_code <- "mmu",
"human" = org_code <- "hsa")
if (Type == "EBseq"){
data$padj <- data$PPEE
}
if (Type == "EBseq"){
data$log2FoldChange <- -1 * log2(data$PostFC)
}
my.symbols <- data$Row.names
gene_IDs<-AnnotationDbi::select(org,keys = my.symbols,
keytype = "SYMBOL",
columns = c("ENTREZID", "SYMBOL", "UNIPROT"))
colnames(gene_IDs) <- c("Row.names","ENTREZID","UNIPROT")
data <- merge(data, gene_IDs, by="Row.names")
data <- data %>% distinct(Row.names, .keep_all = T)
library(dplyr)
data <- data %>% distinct(Row.names, .keep_all = T)
head(data)
data <- read.table(DEG_result,header = T, row.names = 1)
count <- read.table(Count_matrix,header=T, row.names = 1)
data <- merge(data,count, by=0)
data <- read.table(DEG_result,header = T, row.names = 1)
count <- read.table(Count_matrix,header=T, row.names = 1)
data <- merge(data,count, by=0)
my.symbols <- data$Row.names
gene_IDs<-AnnotationDbi::select(org,keys = my.symbols,
keytype = "SYMBOL",
columns = c("ENTREZID", "SYMBOL", "UNIPROT"))
colnames(gene_IDs) <- c("Row.names","ENTREZID","UNIPROT")
data <- merge(data, gene_IDs, by="Row.names")
data <- data %>% distinct(Row.names, .keep_all = T)
if (Type == "EBseq"){
baseMean <- (data$C1Mean + data$C2Mean)*(1/2)
data <- cbind(data, baseMean)
}
##MA-plot
m1 <- as.grob(ggmaplot(data, fdr = fdr, fc = fc, size = 0.4,
palette = c("#B31B21", "#1465AC", "darkgray"),
genenames = as.vector(data$Row.names),
legend = "top", top = 20,
font.label = c("bold", 6),font.legend = "bold",
font.main = "bold",
ggtheme = ggplot2::theme_minimal(),
select.top.method = "fc"))
data2 <- data[abs(data$log2FoldChange) > log(fc, 2),]
data2$group <- "upregulated"
data2$group[data2$log2FoldChange < 0] <- "downregulated"
data3 <- data2[abs(data2$padj) < fdr,]
fdr = 0.05
fc = 2
library(ggplot2)
library(ggpubr)
library(stats4)
library(parallel)
library(dplyr)
library(BiocGenerics)
library(AnnotationDbi)
library(org.Hs.eg.db)
library(enrichplot)
library(ggnewscale)
library(clusterProfiler)
library(genefilter)
library(ComplexHeatmap)
library(grid)
library(ggplotify)
library(tidyverse)
##MA-plot
m1 <- as.grob(ggmaplot(data, fdr = fdr, fc = fc, size = 0.4,
palette = c("#B31B21", "#1465AC", "darkgray"),
genenames = as.vector(data$Row.names),
legend = "top", top = 20,
font.label = c("bold", 6),font.legend = "bold",
font.main = "bold",
ggtheme = ggplot2::theme_minimal(),
select.top.method = "fc"))
if (Type == "EBseq"){
data$padj <- data$PPEE
}
if (Type == "EBseq"){
data$log2FoldChange <- -1 * log2(data$PostFC)
}
##MA-plot
m1 <- as.grob(ggmaplot(data, fdr = fdr, fc = fc, size = 0.4,
palette = c("#B31B21", "#1465AC", "darkgray"),
genenames = as.vector(data$Row.names),
legend = "top", top = 20,
font.label = c("bold", 6),font.legend = "bold",
font.main = "bold",
ggtheme = ggplot2::theme_minimal(),
select.top.method = "fc"))
data2 <- data[abs(data$log2FoldChange) > log(fc, 2),]
data2$group <- "upregulated"
data2$group[data2$log2FoldChange < 0] <- "downregulated"
data3 <- data2[abs(data2$padj) < fdr,]
##heatmap
data.z <- genescale(data3[,8:(7 + Cond_1 + Cond_2)], axis=1, method="Z")
ht <- as.grob(Heatmap(data.z, name = "z-score",
clustering_method_columns = 'ward.D2',
show_row_names = F, show_row_dend = T))
data <- read.table(DEG_result,header = T, row.names = 1)
count <- read.table(Count_matrix,header=T, row.names = 1)
data <- merge(data,count, by=0)
dir_name <- gsub(".txt", "", Count_matrix)
dir_name <- paste(dir_name, paste("_fc", fc, sep = ""), sep = "")
dir_name <- paste(dir_name, paste("_fdr", fdr, sep = ""), sep = "")
dir.create(dir_name, showWarnings = F)
switch (Species,
"mouse" = org <- org.Mm.eg.db,
"human" = org <- org.Hs.eg.db)
switch (Species,
"mouse" = org_code <- "mmu",
"human" = org_code <- "hsa")
if (Type == "EBseq"){
data$padj <- data$PPEE
}
if (Type == "EBseq"){
data$log2FoldChange <- -1 * log2(data$PostFC)
}
my.symbols <- data$Row.names
gene_IDs<-AnnotationDbi::select(org,keys = my.symbols,
keytype = "SYMBOL",
columns = c("ENTREZID", "SYMBOL", "UNIPROT"))
colnames(gene_IDs) <- c("Row.names","ENTREZID","UNIPROT")
data <- merge(data, gene_IDs, by="Row.names")
data <- data %>% distinct(Row.names, .keep_all = T)
if (Type == "EBseq"){
baseMean <- (data$C1Mean + data$C2Mean)*(1/2)
data <- cbind(data, baseMean)
}
##MA-plot
m1 <- as.grob(ggmaplot(data, fdr = fdr, fc = fc, size = 0.4,
palette = c("#B31B21", "#1465AC", "darkgray"),
genenames = as.vector(data$Row.names),
legend = "top", top = 20,
font.label = c("bold", 6),font.legend = "bold",
font.main = "bold",
ggtheme = ggplot2::theme_minimal(),
select.top.method = "fc"))
data2 <- data[abs(data$log2FoldChange) > log(fc, 2),]
data2$group <- "upregulated"
data2$group[data2$log2FoldChange < 0] <- "downregulated"
data3 <- data2[abs(data2$padj) < fdr,]
##heatmap
data.z <- genescale(data3[,8:(7 + Cond_1 + Cond_2)], axis=1, method="Z")
ht <- as.grob(Heatmap(data.z, name = "z-score",
clustering_method_columns = 'ward.D2',
show_row_names = F, show_row_dend = T))
ma_name <- paste(paste(dir_name, "/", sep = ""),
"ma-heatmap.pdf", sep = "")
pdf(ma_name, width = 7, height = 3.5)
print(plot_grid(m1, ht, rel_widths = c(2, 1)))
dev.off()
#dotplot
universe <- AnnotationDbi::select(org,keys = rownames(count),
keytype = "SYMBOL",
columns = c("ENTREZID", "SYMBOL", "UNIPROT"))
formula_res <- compareCluster(ENTREZID~group, data=data3,fun="enrichKEGG", organism=org_code, universe = universe)
if (length(as.data.frame(formula_res)) == 0) {
p1 <- NULL
} else{
p1 <- as.grob(dotplot(formula_res, color ="qvalue", font.size = 9))
keggenrich_name <- paste(paste(dir_name, "/", sep = ""),
"kegg_enrich.csv", sep = "")
write.table(as.data.frame(formula_res), file = keggenrich_name, row.names = F, col.names = T, sep = ",", quote = F)
}
##cnetplot
upgene <- data3[data3$log2FoldChange > log(fc, 2),]
geneList_up <- upgene$log2FoldChange
names(geneList_up) = as.character(upgene$ENTREZID)
kk1 <- enrichKEGG(upgene$ENTREZID, organism =org_code,
pvalueCutoff = 0.05, minGSSize = 50, maxGSSize = 500)
cnet1 <- setReadable(kk1, org, 'ENTREZID')
if (length(cnet1$ID) == 0) {
p2 <- NULL
} else{
p2 <- as.grob(cnetplot(cnet1, foldChange=geneList_up,
cex_label_gene = 0.5, cex_label_category = 0.75,
cex_category = 0.5, colorEdge = TRUE))
}
downgene <- data3[data3$log2FoldChange < log(1/fc, 2),]
geneList_down <- downgene$log2FoldChange
names(geneList_down) = as.character(downgene$ENTREZID)
kk2 <- enrichKEGG(downgene$ENTREZID, organism =org_code,
pvalueCutoff = 0.05, minGSSize = 50, maxGSSize = 500)
cnet2 <- setReadable(kk2, org, 'ENTREZID')
if (length(cnet2$ID) == 0) {
p3 <- NULL
} else{
p3 <- as.grob(cnetplot(cnet2, foldChange=geneList_down,
cex_label_gene = 0.5, cex_label_category = 0.75,
cex_category = 0.5, colorEdge = TRUE))
}
##GSEA plot
data <- na.omit(data)
geneList <- data$log2FoldChange
names(geneList) = as.character(data$UNIPROT)
geneList <- sort(geneList, decreasing = TRUE)
kk2 <- gseKEGG(geneList = geneList, pvalueCutoff = 0.05,
organism = org_code, keyType = "uniprot",
exponent = 1, eps = 0, pAdjustMethod = "none",
minGSSize = 50, maxGSSize = 500, by = "fgsea",
use_internal_data = FALSE)
data10 <- data %>% distinct(UNIPROT, .keep_all = T)
data <- na.omit(data)
geneList <- data10$log2FoldChange
names(geneList) = as.character(data10$UNIPROT)
geneList <- sort(geneList, decreasing = TRUE)
kk2 <- gseKEGG(geneList = geneList, pvalueCutoff = 0.05,
organism = org_code, keyType = "uniprot",
exponent = 1, eps = 0, pAdjustMethod = "none",
minGSSize = 50, maxGSSize = 500, by = "fgsea",
use_internal_data = FALSE)
##GSEA plot
data <- na.omit(data)
geneList <- data$log2FoldChange
names(geneList) = as.character(data$ENTREZID)
geneList <- sort(geneList, decreasing = TRUE)
go3 <- gseGO(geneList = geneList, pvalueCutoff = 0.05,
OrgDb = org, exponent = 1, eps = 0,
pAdjustMethod = "none", minGSSize = 50,
maxGSSize = 500, by = "fgsea")
data11 <- data %>% distinct(ENTREZID, .keep_all = T)
devtools::install_github("Kan-E/rnaseqviewer")
setwd("~/Downloads/RNA-seq analysis/aKG-p53 paper")
rnaseqviewer::DEG_overview(Count_matrix = "GeneMat_TPM_pair.txt",DEG_result = "GeneMat_Count_result_new.txt",Species = "mouse")
rnaseqviewer::DEG_overview(Count_matrix = "GeneMat_TPM_pair.txt",DEG_result = "GeneMat_Count_result_new.txt",Species = "mouse",Cond_1 = 2,Cond_2 = 2)
use_github_action_check_standard()
usethis::use_github_action_check_standard()
setwd("~/Desktop/Rproject/rnaseqviewer")
usethis::use_github_action_check_standard()
devtools::load_all(".")
setwd("~/Downloads/RNA-seq analysis/20200518_RNA-seq_TPM_analysis_eto/PQS/EBseq_result")
rnaseqviewer::multiDEG_overview(Normalized_count_matrix = "ALL_TPM.txt", EBseq_result = "GeneMat_result_new.txt", EBseq_condmeans = "GeneMat_result_condmeans.txt", Species = "human")
devtools::load_all("~/Desktop/Rproject/rnaseqviewer")
devtools::load_all("~/Desktop/Rproject/rnaseqviewer")
rnaseqviewer::multiDEG_overview(Normalized_count_matrix = "ALL_TPM.txt", EBseq_result = "GeneMat_result_new.txt", EBseq_condmeans = "GeneMat_result_condmeans.txt", Species = "human")
rnaseqviewer::multiDEG_overview(Normalized_count_matrix = "ALL_TPM.txt", EBseq_result = "GeneMat_result_new.txt", EBseq_condmeans = "GeneMat_result_condmeans.txt", Species = "human")
devtools::load_all("~/Desktop/Rproject/rnaseqviewer")
rnaseqviewer::multiDEG_overview(Normalized_count_matrix = "ALL_TPM.txt", EBseq_result = "GeneMat_result_new.txt", EBseq_condmeans = "GeneMat_result_condmeans.txt", Species = "human")
devtools::load_all("~/Desktop/Rproject/rnaseqviewer")
rnaseqviewer::multiDEG_overview(Normalized_count_matrix = "ALL_TPM.txt", EBseq_result = "GeneMat_result_new.txt", EBseq_condmeans = "GeneMat_result_condmeans.txt", Species = "human")
library(clusterProfiler.dplyr)
sessionInfo()
devtools::load_all("~/Desktop/Rproject/rnaseqviewer")
devtools::load_all("~/Desktop/Rproject/rnaseqviewer")
rnaseqviewer::multiDEG_overview(Normalized_count_matrix = "ALL_TPM.txt", EBseq_result = "GeneMat_result_new.txt", EBseq_condmeans = "GeneMat_result_condmeans.txt", Species = "human")
devtools::load_all("~/Desktop/Rproject/rnaseqviewer")
rnaseqviewer::multiDEG_overview(Normalized_count_matrix = "ALL_TPM.txt", EBseq_result = "GeneMat_result_new.txt", EBseq_condmeans = "GeneMat_result_condmeans.txt", Species = "human")
devtools::load_all("~/Desktop/Rproject/rnaseqviewer")
setwd("~/Desktop/デモデータ/acly")
rnaseqviewer::DEG_overview(Count_matrix = "GeneMat_TPM.txt", DEG_result ="GeneMat_result_new.txt", Type = "EBseq",
Species ="human", Cond_1 = 3, Cond_2 = 3,
fdr = 0.05, fc = 2)
library(rnaseqviewer)
devtools::install_github("Kan-E/rnaseqviewer")
setwd("~/Downloads/RNA-seq analysis/20200518_RNA-seq_TPM_analysis_eto/PQS/EBseq_result/ALL_TPM_fc2_fdr0.05_basemean0")
rnaseqviewer::kmeansClustring(Count_matrix = "Sen_sig_TPM.csv", Species = "human", km =3, km_repeats = 1000)
rnaseqviewer::kmeansClustring(Count_matrix = "Sen_sig_TPM.csv", Species = "human", km =3, km_repeats = 1000, basemean_cutoff = 0, variance_cutoff = 10000)
devtools::load_all("~/Desktop/Rproject/rnaseqviewer")
setwd("~/Downloads/RNA-seq analysis/20200518_RNA-seq_TPM_analysis_eto/PQS/EBseq_result")
multiDEG_overview(Normalized_count_matrix = "ALL_TPM.txt",EBseq_result = "GeneMat_result_new.txt",EBseq_condmeans = "GeneMat_result_condmeans.txt",Species = "human")
setwd("~/Downloads/RNA-seq analysis/20200518_RNA-seq_TPM_analysis_eto/PQS/EBseq_result/ALL_TPM_fc2_fdr0.05_basemean0")
kmeansClustring(Count_matrix = "Sen_sig_TPM.txt", Species = "human", km =3, km_repeats = 1000, basemean_cutoff = 0, variance_cutoff = 10000)
library(rnaseqviewer)
devtools::load_all("~/Desktop/Rproject/rnaseqviewer")
devtools::install_github("Kan-E/rnaseqviewer")
